<!-- <!DOCTYPE html>
<html>
  <head>
    <title>Socket.io Client</title>
  </head>
  <body>
    <h1>Real-Time Location Updates</h1>
    <div id="location"></div>

    <button onclick="pokeFriend()">Poke</button>
    <button onclick="unpokeFriend()">Unpoke</button>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io({
        query: {
          token:
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY2NmMzMjUyYzY3YzYwZTM0ZmNhYTEzNiIsImlhdCI6MTcxOTY2NzI2MCwiZXhwIjoxNzE5Njc0NDYwfQ.T13lraMCWhuaz0mA68zWdDpiRbteI_bhFGASd3R21m4", // Replace with the user's JWT token
        },
      });

      socket.on("connect", () => {
        console.log("Connected to server");
      });

      socket.on("locationUpdated", (data) => {
        const locationDiv = document.getElementById("location");
        locationDiv.innerHTML = `User ${data.userId} updated location to:
      Latitude: ${data.latitude}, Longitude: ${data.longitude}`;
      });

      socket.on("newFriendRequest", (data) => {
        console.log("New friend request received", data);
        // Add code to display notification to the user
        alert(`You have a new friend request from ${data.senderId}`);
      });

      // New poke event handler
      socket.on("poked", (data) => {
        console.log("You've been poked by", data.senderName);
        alert(`You've been poked by ${data.senderName}`);
      });

      socket.on("unpoked", (data) => {
        console.log("You've been unpoked by", data.senderName);
        alert(`You've been unpoked by ${data.senderName}`);
      });

      socket.on("error", (error) => {
        console.error("Error:", error);
      });

      function sendLocationUpdate(latitude, longitude) {
        socket.emit("updateLocation", { latitude, longitude });
      }

      function pokeFriend() {
        const friendId = "666c3252c67c60e34fcaa136";
        socket.emit("pokeFriend", friendId);
      }

      function unpokeFriend() {
        const friendId = "666c3252c67c60e34fcaa136";
        socket.emit("unpokeFriend", friendId);
      }

      // Example: Update location every 5 seconds
      setInterval(() => {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition((position) => {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            sendLocationUpdate(latitude, longitude);
          });
        } else {
          console.error("Geolocation is not supported by this browser.");
        }
      }, 5000);
    </script>
  </body>
</html> -->

<!DOCTYPE html>
<html>
  <head>
    <title>Socket.io Client</title>
  </head>
  <body>
    <h1>Real-Time Location Updates</h1>
    <div id="location"></div>

    <h2>Friend Actions</h2>
    <button onclick="pokeFriend()">Poke Friend</button>
    <button onclick="unpokeFriend()">Unpoke Friend</button>
    <button onclick="sendFriendRequest()">Send Friend Request</button>
    <button onclick="acceptFriendRequest()">Accept Friend Request</button>
    <button onclick="rejectFriendRequest()">Reject Friend Request</button>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io({
        query: {
          token:
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY2ODY4OTllNDBmN2E0Mjk2ZWJjZjBjNSIsImlhdCI6MTcyMDA5MzM3NCwiZXhwIjoxNzIwMTAwNTc0fQ.yVbsI0jsQgRwameRXzzRYm4IMF_AfPS5ctz09yj58Qk", // Replace with the user's JWT token
        },
      });

      socket.on("connect", () => {
        console.log("Connected to server");
      });

      socket.on("locationUpdated", (data) => {
        const locationDiv = document.getElementById("location");
        locationDiv.innerHTML = `User ${data.userId} updated location to:
              Latitude: ${data.latitude}, Longitude: ${data.longitude}`;
      });

      socket.on("newFriendRequest", (data) => {
        console.log("New friend request received", data);
        alert(`You have a new friend request from ${data.senderId}`);
      });

      socket.on("poked", (data) => {
        console.log("You've been poked by", data.senderName);
        alert(`You've been poked by ${data.senderName}`);
      });

      socket.on("unpoked", (data) => {
        console.log("You've been unpoked by", data.senderName);
        alert(`You've been unpoked by ${data.senderName}`);
      });

      socket.on("friendRequestAccepted", (data) => {
        console.log("Friend request accepted by", data.receiverUsername);
        alert(`Friend request accepted by ${data.receiverUsername}`);
      });

      socket.on("friendRequestRejected", (data) => {
        console.log("Friend request rejected by", data.receiverUsername);
        alert(`Friend request rejected by ${data.receiverUsername}`);
      });

      socket.on("error", (error) => {
        console.error("Error:", error);
        alert("Error: " + error);
      });

      function sendLocationUpdate(latitude, longitude) {
        socket.emit("updateLocation", { latitude, longitude });
      }

      function pokeFriend() {
        const friendId = "666c3252c67c60e34fcaa136";
        socket.emit("pokeFriend", friendId);
      }

      function unpokeFriend() {
        const friendId = "666c3252c67c60e34fcaa136";
        socket.emit("unpokeFriend", friendId);
      }

      function sendFriendRequest() {
        const receiverId = "666c3252c67c60e34fcaa136";
        if (receiverId) {
          socket.emit("sendFriendRequest", receiverId);
        }
      }

      function acceptFriendRequest() {
        const senderId = "666c31b9c67c60e34fcaa12a";
        const receiverId = "666c3252c67c60e34fcaa136"; // Replace with current user's ID
        if (senderId) {
          socket.emit("acceptFriendRequest", { senderId, receiverId });
        }
      }

      function rejectFriendRequest() {
        const senderId = "666c31b9c67c60e34fcaa12a";
        const receiverId = "666c3252c67c60e34fcaa136";
        if (senderId && receiverId) {
          socket.emit("rejectFriendRequest", { senderId, receiverId });
        }
      }

      // function rejectFriendRequest() {
      //   const senderId = "666ad935479d689df2021811";
      //   if (senderId) {
      //     socket.emit("rejectFriendRequest", senderId);
      //   }
      // }

      // Example: Update location every 5 seconds
      setInterval(() => {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition((position) => {
            const latitude = position.coords.latitude;
            const longitude = position.coords.longitude;
            sendLocationUpdate(latitude, longitude);
          });
        } else {
          console.error("Geolocation is not supported by this browser.");
        }
      }, 5000);
    </script>
  </body>
</html>
